<!DOCTYPE html>
<html>
    <head>
   <!--
        Providers
        Author: Adam Rhoades
        Date:   9/23/2019
        Filename: MIA_providers.html
   -->
   
        <title>Magnate Streaming Service</title>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />  
        <link rel="stylesheet" href="css/tf_styles1.css">
        <link rel="stylesheet" href="css/tf_flex.css">
        <link rel="stylesheet" href="css/tf_reset.css">
        <link rel="stylesheet" href="css/tf_navicon.css">
   <!-- Add icon library -->
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    </head>
    <body>
        
        <script>
            sessionStorage.setItem("signout", "out");
        </script>
        <header>
            <a href="MSS_Home.html" ><img src="img/kimlogobanner.png" alt="Magnate Streaming Service" style="background:center no-repeat; max-width:300px;
            max-height:200px;
            width:auto;
            height:auto;"></a>
      
            <nav class="horizontal">
                <a id="navicon" href="#" style="width:30px;height:30;"><img src="img/tf_navicon.png" alt=""></a>
                <ul class="mainmenu" style="margin: 0px 0px 0px 0px; padding: 0px 0px 0px 0px;">
                    <li><a href="MSS_Home.html" style="width: auto;  margin: 0px 0px 0px 0px;padding: 5px 5px 5px 5px;">Home</a></li>
                    <li><a href="MSS_Movie.html" style="width: auto; margin: 0px 0px 0px 0px;padding: 5px 5px 5px 5px;">Movies</a></li>
                    <li><a href="MSS_Podcast.html" style="width: auto; margin: 0px 0px 0px 0px;padding: 5px 5px 5px 5px;">Podcast</a></li>
                    <li><a href="MSS_Music.html" style="width: auto; margin: 0px 0px 0px 0px;padding: 5px 5px 5px 5px;" >Music</a></li>
                    <li><a href="MSS_Upload.html" style="width: auto; margin: 0px 0px 0px 0px;padding: 5px 5px 5px 5px;" >Upload</a></li>
                    <li><a href="MSS_MngUpload.html" style="width: auto; margin: 0px 0px 0px 0px;padding: 5px 5px 5px 5px;" >Manage Upload</a></li>
                    <li><a href="MSS_Profile.html" style="width: auto; margin: 0px 0px 0px 0px;padding: 5px 5px 5px 5px;" >Profile</a></li>
                    <li><a href="MSS_Manage_Payment.html" id="currentPage" style="width: auto; margin: 0px 0px 0px 0px;padding: 5px 5px 5px 5px;" >Manage Payment</a></li>
                    <li><a href="Login.html" style="width: auto; margin: 0px 0px 0px 0px;padding: 5px 5px 5px 5px;" >Sign-Out</a></li>
		</ul>
            </nav>
        </header>
        
        <section style="width:100%;background-color: rgb(0,0,0); padding:20px 5px 20px 5px;">
            <form style="width:300px; text-align: center; margin: auto; left: 0; right: 0; top: 0; bottom: 0; " id="register" action="MIA_submit.php" method="post" >
                <fieldset style="border-radius: 2%; background: rgb(255 ,255, 255) ;" id="userInfo">
                    <legend style="color:rgb(255,255,255); background: rgb(0 ,0, 0); font-weight: bold;">New User</legend>

                        <h1 class="row" >Card Information</h1>
                        <div class="row" style="padding:5px 5px 5px 5px;margin:5px 5px 5px 5px; width:280px;">
                            <label for="cardholder" >Card Holder*</label>
                            <input name="custcardholder" id="cardholder" type="text" value="" required />
                        </div>
                        <div class="row" style="padding:5px 5px 5px 5px;margin:5px 5px 5px 5px; width:280px;">
                            <label for="cardnumber">Card Number</label>
                            <input name="custcardnumber" id="cardnumber" type="text" pattern="^\d{5}(-\d{4})?$" />	
                        </div>
                        <div class="row" style="text-align: center; width:300px; display: flex;" >
                            <div class="column" style="width:150px; padding:5px 5px 5px 5px; margin:0px 5px 0px 5px;">
                                <label style="margin:5px 5px 5px 5px;" for="CVC">CVV/CVN*</label>
                                <input style="width:80px; margin:5px 5px 5px 5px;" name="custCVC" id="CVC" type="text" placeholder="021" required />
                            </div>
                            <div class="column" style=" width:150px;padding:5px 5px 5px 5px; margin:0px 5px 0px 5px;">
                                <label style="margin:5px 5px 5px 5px;" for="expo" >Experation Date*</label>
                                <input style="width:130px; margin:5px 5px 5px 5px;" name="custexpo" id="expo" type="text" placeholder="mm-yyyy" required />
                            </div>
                        </div>
						
		</fieldset>		
			
		<div class="r1" style="max-width:400px;  padding-top:5px;">
			<a ><button type="button" class="cancelbtn" id="create" onclick="upload()" >Create</button></a>
			<a href="MSS_Profile.html" ><button type="button" class="cancelbtn">Cancel</button></a>
		</div>
            <!-- The core Firebase JS SDK is always required and must be listed first -->
<script src="https://www.gstatic.com/firebasejs/8.6.0/firebase-app.js"></script>

<!-- TODO: Add SDKs for Firebase products that you want to use
     https://firebase.google.com/docs/web/setup#available-libraries -->
<!-- <script src="https://www.gstatic.com/firebasejs/8.6.0/firebase-analytics.js"></script>-->
<script src="https://www.gstatic.com/firebasejs/8.6.0/firebase-database.js"></script>

<script>
  // Your web app's Firebase configuration
  // For Firebase JS SDK v7.20.0 and later, measurementId is optional
  var firebaseConfig = {
    apiKey: "AIzaSyBKpk7-U_TkE3IApTOZFSMNIXuOg-PYPFs",
    authDomain: "kims-streamer.firebaseapp.com",
    databaseURL: "https://kims-streamer-default-rtdb.firebaseio.com",
    projectId: "kims-streamer",
    storageBucket: "kims-streamer.appspot.com",
    messagingSenderId: "1059071438295",
    appId: "1:1059071438295:web:71a7266e044585eb61ef92",
    measurementId: "G-J3LQRTX4SH"
  };
  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);
  firebase.analytics();
  
  function upload(){
                    
                    var username = sessionStorage.getItem("user");
                    var cardnumber = document.getElementById('cardnumber').value;
                    var cardholder = document.getElementById('cardholder').value;
                    var CVC = document.getElementById('CVC').value;
                    var expo = document.getElementById('expo').value;

                            document.getElementById('cardnumber').style.background = "rgb(255,255,255)";

                            document.getElementById('cardholder').style.background = "rgb(255,255,255)";

                            document.getElementById('CVC').style.background = "rgb(255,255,255)";

                            document.getElementById('expo').style.background = "rgb(255,255,255)";
                  
                    //alert(password+ "  +  "+ username)
                    if (cardnumber !== "" && cardholder !== "" && CVC !== "" && expo !== ""){
                        firebase.database().ref().child('usersprofile').once('value',function(snapshot) {
                            if(snapshot.hasChild(username)){
                                    firebase.database().ref().child('usersprofile').child(username).update({
                                        
                                        cardHolder: cardholder,
                                        cardNumber: cardnumber,
                                        cvc: CVC,
                                        experation: expo,
                                    });
                                    
                                    sessionStorage.setItem("code", cardnumber.substr(-4));
                                    
                                    window.location.href = "MSS_Profile.html";
                                
                            }
                        });
                    }
                    
                    
                    
                    
                    else{
                        
                        if(cardnumber === ""){
                            document.getElementById('cardnumber').value = ""
                            document.getElementById('cardnumber').style.background = "rgb(255,50,0)";
                            document.getElementById('cardnumber').placeholder = "1234-5678-9012-3456";
                        } 
                        if(cardholder === ""){
                            document.getElementById('cardholder').value = ""
                            document.getElementById('cardholder').style.background = "rgb(255,50,0)";
                            document.getElementById('cardholder').placeholder = "name";
                        } 
                        if(CVC === ""){
                            document.getElementById('CVC').value = ""
                            document.getElementById('CVC').style.background = "rgb(255,50,0)";
                            document.getElementById('CVC').placeholder = "012";
                        } 
                        if(expo === ""){
                            document.getElementById('expo').value = ""
                            document.getElementById('expo').style.background = "rgb(255,50,0)";
                            document.getElementById('expo').placeholder = "mm-yyyy";
                        }
                    }
        };
    </script>
            
	 </form>
	 
   </section>
   <footer >
        <a href="" class="facebook"><i class="fa fa-facebook" ></i></a>
        <a href="" class="fa fa-google" id="google"></a>
	</footer>
</body>
</html>
